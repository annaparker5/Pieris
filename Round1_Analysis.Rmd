---
title: "Round1_Analysis"
output: html_notebook
---

0. Load in packages and data sets
1. Compare mass and dev time of larval pupal intermediates with pupae across temps
2. Compare mass and dev time of deformed adults with adults across temps
3. Make data frame with means and standard errors across temps
4. Make graphs 

# 0. Load in packages and data sets
```{r}
library(dplyr)
library(ggplot2)
library(lmerTest)
library(Rmisc)
```
```{r}
data <- read.csv("~/Desktop/Github/Pieris/Data/CleanedRound1.csv", header = TRUE)

data$Mean.Temp <- as.factor(data$Mean.Temp)
```

# 1. Compare larval pupal ints with successful pupae

## Mass at pupation

```{r}
masspupae <- lm(Mass.pupa ~ PupateOk*Mean.Temp, data = data[data$Surv.pupa == "Y", ])

anova(masspupae)

summary(masspupae)
```
Drop the non-significant interaction term


```{r}
masspupaeadd <- lm(Mass.pupa ~ PupateOk + Mean.Temp, data = data[data$Surv.pupa == "Y", ])

anova(masspupaeadd)

summary(masspupaeadd)
```


## Time at pupation


```{r}
timepupae <- lm(Time.pupa ~ PupateOk*Mean.Temp, data = data[data$Surv.pupa == "Y", ])

anova(timepupae)

summary(timepupae)
```

Drop insignificant interaction term

```{r}
timepupaeadd <- lm(Time.pupa ~ PupateOk + Mean.Temp, data = data[data$Surv.pupa == "Y", ])

anova(timepupaeadd)

summary(timepupaeadd)
```

# 2. Compare adults 


# 3. Get means for different groups

## Pupal mass

Separating out LPI and successful pupae 

### Mean mass and SE

```{r}
pupalmeans <- summarySE(data = data[data$Surv.pupa == "Y", ], measurevar = "Mass.pupa", groupvars = c("Mean.Temp", "PupateOk"))

pupalmeans

pupalmeans$Mass.se <- pupalmeans$se

pupalmeans <- pupalmeans %>%
  select(Mean.Temp, PupateOk, N, Mass.pupa, Mass.se)


```

### Mean dev time and SE

```{r}
pupaltimemeans <- summarySE(data = data[data$Surv.pupa == "Y", ], measurevar = "Time.pupa", groupvars = c("Mean.Temp", "PupateOk"))

pupaltimemeans

pupaltimemeans$Time.se <- pupaltimemeans$se

pupaltimemeans <- pupaltimemeans %>%
  select(Mean.Temp, PupateOk, N, Time.pupa, Time.se)
```

### Merge together

```{r}
pupalmeans <- merge(pupalmeans, pupaltimemeans, by = c("Mean.Temp", "PupateOk", "N"))
```



# 4. Graphing everything

## Endpoints of pupal mass and dev time


```{r}
pupalgraph <- ggplot(data = pupalmeans, aes(x = Time.pupa, y = Mass.pupa, color = Mean.Temp, shape = PupateOk)) + 
  theme_bw() + 
  geom_point(size = 3) + 
  geom_errorbar(aes(ymin = Mass.pupa - Mass.se, ymax = Mass.pupa + Mass.se)) + 
  geom_errorbarh(aes(xmin = Time.pupa - Time.se, xmax = Time.pupa + Time.se)) + 
  guides(scale = "none") + 
  scale_color_manual(values = c("purple", "#1E88E5", "lime green", "orange", "#D81B60")) + 
  scale_shape_manual(values = c(21, 19)) + 
  labs(x = "Time until pupation (days)", y = "Mass at pupation (mg)", color = "Mean temperature treatment", shape = "Successful Pupation")


pupalgraph

ggsave("~/Desktop/GitHub/Pieris/Figures/pupalgraph.png", pupalgraph, width = 8, height = 5)

```


